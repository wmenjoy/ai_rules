# Javaç¼–ç¨‹è§„èŒƒè¯¦ç»†å®æ–½æŒ‡å—
> åŸºäºæ¦‚è§ˆæ¶æ„çš„å…·ä½“è§„åˆ™å®šä¹‰å’Œæ‰§è¡Œæ ‡å‡†

## ğŸ¯ è§„èŒƒæ‰§è¡Œæ¡†æ¶

### ä¼˜å…ˆçº§å®šä¹‰
- **ğŸ”´ MUST (L1)**ï¼šå¿…é¡»ä¸¥æ ¼éµå®ˆï¼Œè¿åå°†é˜»æ­¢ä»£ç åˆå¹¶
- **ğŸŸ¡ SHOULD (L2)**ï¼šå¼ºçƒˆå»ºè®®éµå®ˆï¼Œè¿åéœ€è¦è¯´æ˜ç†ç”±
- **ğŸŸ¢ MAY (L3)**ï¼šæ¨èéµå®ˆï¼Œä½œä¸ºä»£ç è´¨é‡æå‡å»ºè®®

### éªŒè¯å±‚çº§
- **é™æ€æ£€æŸ¥**ï¼šç¼–è¯‘æ—¶å’ŒIDEå®æ—¶æ£€æŸ¥
- **åŠ¨æ€æ£€æŸ¥**ï¼šè¿è¡Œæ—¶å’Œæµ‹è¯•é˜¶æ®µæ£€æŸ¥
- **äººå·¥å®¡æŸ¥**ï¼šä»£ç è¯„å®¡å’Œæ¶æ„å®¡æŸ¥

## ğŸ“‹ æ ¸å¿ƒè§„èŒƒå±‚è¯¦ç»†å®šä¹‰

### 1. Javaç¼–ç è§„èŒƒ (java-coding-standards.mdc)

#### ä»£ç æ ¼å¼åŒ– [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… æ­£ç¡®çš„ç¼©è¿›å’Œæ¢è¡Œ
public class UserService {
    private static final int MAX_RETRY_COUNT = 3;
    
    public User createUser(String name, String email) {
        if (StringUtils.isEmpty(name) || StringUtils.isEmpty(email)) {
            throw new IllegalArgumentException("Name and email cannot be empty");
        }
        
        User user = User.builder()
            .name(name)
            .email(email)
            .createTime(LocalDateTime.now())
            .build();
            
        return userRepository.save(user);
    }
}
// [AI-BLOCK-END]
```

**æ ¼å¼åŒ–è§„åˆ™**ï¼š
- ç¼©è¿›ï¼š4ä¸ªç©ºæ ¼ï¼Œç¦ç”¨Tabå­—ç¬¦
- è¡Œé•¿åº¦ï¼šä¸è¶…è¿‡120å­—ç¬¦
- å¤§æ‹¬å·ï¼šK&Ré£æ ¼ï¼Œå·¦å¤§æ‹¬å·ä¸æ¢è¡Œ
- ç©ºè¡Œï¼šæ–¹æ³•é—´1ä¸ªç©ºè¡Œï¼Œé€»è¾‘å—é—´1ä¸ªç©ºè¡Œ

#### å˜é‡å£°æ˜è§„èŒƒ [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… æ­£ç¡®çš„å˜é‡å£°æ˜
public class OrderProcessor {
    // å¸¸é‡ï¼šå…¨å¤§å†™ï¼Œä¸‹åˆ’çº¿åˆ†éš”
    private static final String ORDER_STATUS_PENDING = "PENDING";
    private static final int DEFAULT_TIMEOUT = 30;
    
    // å®ä¾‹å˜é‡ï¼šä½¿ç”¨finalä¿®é¥°ä¸å¯å˜å­—æ®µ
    private final UserService userService;
    private final OrderRepository orderRepository;
    
    // å±€éƒ¨å˜é‡ï¼šå°½å¯èƒ½ä½¿ç”¨final
    public void processOrder(final Long orderId) {
        final Order order = orderRepository.findById(orderId);
        final User user = userService.findById(order.getUserId());
        
        // éfinalå˜é‡éœ€è¦æœ‰æ˜ç¡®çš„ä¿®æ”¹ç†ç”±
        OrderStatus status = OrderStatus.PENDING;
        if (user.isVip()) {
            status = OrderStatus.PRIORITY;
        }
    }
}
// [AI-BLOCK-END]
```

#### æ–¹æ³•è®¾è®¡åŸåˆ™ [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… è‰¯å¥½çš„æ–¹æ³•è®¾è®¡
public class PaymentService {
    
    // æ–¹æ³•å‚æ•°ä¸è¶…è¿‡5ä¸ªï¼Œä½¿ç”¨å¯¹è±¡å°è£…å¤æ‚å‚æ•°
    public PaymentResult processPayment(PaymentRequest request) {
        validatePaymentRequest(request);
        
        try {
            return doProcessPayment(request);
        } catch (PaymentException e) {
            log.error("Payment processing failed for order: {}", request.getOrderId(), e);
            return PaymentResult.failure(e.getMessage());
        }
    }
    
    // ç§æœ‰æ–¹æ³•èŒè´£å•ä¸€ï¼Œåç§°æ¸…æ™°
    private void validatePaymentRequest(PaymentRequest request) {
        Objects.requireNonNull(request, "Payment request cannot be null");
        Objects.requireNonNull(request.getOrderId(), "Order ID cannot be null");
        
        if (request.getAmount().compareTo(BigDecimal.ZERO) <= 0) {
            throw new IllegalArgumentException("Payment amount must be positive");
        }
    }
    
    // è¿”å›å€¼ç±»å‹æ˜ç¡®ï¼Œé¿å…è¿”å›null
    private Optional<User> findUserByEmail(String email) {
        return userRepository.findByEmail(email);
    }
}
// [AI-BLOCK-END]
```

#### å¼‚å¸¸å¤„ç†è§„èŒƒ [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… æ­£ç¡®çš„å¼‚å¸¸å¤„ç†
@Service
public class FileProcessorService {
    
    // ä¸šåŠ¡å¼‚å¸¸ï¼šç»§æ‰¿RuntimeExceptionï¼ŒåŒ…å«é”™è¯¯ç 
    public void processFile(String filePath) {
        try {
            validateFilePath(filePath);
            doProcessFile(filePath);
        } catch (IOException e) {
            // è½¬æ¢ä¸ºä¸šåŠ¡å¼‚å¸¸ï¼Œä¿ç•™åŸå§‹å¼‚å¸¸ä¿¡æ¯
            throw new FileProcessingException("Failed to process file: " + filePath, e);
        } catch (SecurityException e) {
            // è®°å½•å®‰å…¨å¼‚å¸¸ï¼Œä¸æš´éœ²æ•æ„Ÿä¿¡æ¯
            log.error("Security violation during file processing", e);
            throw new FileProcessingException("Access denied for file processing");
        }
    }
    
    // è‡ªå®šä¹‰å¼‚å¸¸ç±»
    public static class FileProcessingException extends RuntimeException {
        private final String errorCode;
        
        public FileProcessingException(String message) {
            this(message, "FILE_PROCESSING_ERROR");
        }
        
        public FileProcessingException(String message, Throwable cause) {
            this(message, cause, "FILE_PROCESSING_ERROR");
        }
        
        public FileProcessingException(String message, String errorCode) {
            super(message);
            this.errorCode = errorCode;
        }
        
        public FileProcessingException(String message, Throwable cause, String errorCode) {
            super(message, cause);
            this.errorCode = errorCode;
        }
        
        public String getErrorCode() {
            return errorCode;
        }
    }
}
// [AI-BLOCK-END]
```

### 2. å‘½åè§„èŒƒ (naming-conventions.mdc)

#### ç±»å‘½åè§„èŒƒ [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… æ­£ç¡®çš„ç±»å‘½å
public class UserAccountService { }          // æœåŠ¡ç±»ï¼šåè¯ + Service
public class OrderStatusConverter { }        // è½¬æ¢ç±»ï¼šåè¯ + Converter
public class PaymentValidator { }            // éªŒè¯ç±»ï¼šåè¯ + Validator
public class EmailNotificationHandler { }    // å¤„ç†ç±»ï¼šåè¯ + Handler
public abstract class AbstractUserRepository { } // æŠ½è±¡ç±»ï¼šAbstract + åè¯
public interface UserRepository { }          // æ¥å£ï¼šåè¯ï¼Œä¸ä½¿ç”¨Iå‰ç¼€

// æšä¸¾ç±»å‘½å
public enum OrderStatus {
    PENDING, CONFIRMED, SHIPPED, DELIVERED, CANCELLED
}

// å¼‚å¸¸ç±»å‘½å
public class InvalidUserStateException extends RuntimeException { }
public class OrderNotFoundException extends RuntimeException { }
// [AI-BLOCK-END]
```

#### æ–¹æ³•å‘½åè§„èŒƒ [MUST - L1]
```java
// [AI-BLOCK-START] - ç”Ÿæˆå·¥å…·: è§„èŒƒç¤ºä¾‹ v1.0
// âœ… æ­£ç¡®çš„æ–¹æ³•å‘½å
public class UserService {
    
    // æŸ¥è¯¢æ–¹æ³•ï¼šfind/get/query + åè¯
    public User findUserById(Long id) { }
    public List<User> findUsersByStatus(UserStatus status) { }
    public Optional<User> getUserByEmail(String email) { }
    public Page<User> queryActiveUsers(Pageable pageable) { }
    
    // åˆ¤æ–­æ–¹æ³•ï¼šis/has/can + å½¢å®¹è¯/åè¯
    public boolean isUserActive(Long userId) { }
    public boolean hasValidEmail(String email) { }
    public boolean canUserAccess(Long userId, String resource) { }
    
    // åˆ›å»ºæ–¹æ³•ï¼šcreate/build/generate + åè¯
    public User createUser(CreateUserRequest request) { }
    public UserProfile buildUserProfile(User user) { }
    public String generateUserToken(Long userId) { }
    
    // æ›´æ–°æ–¹æ³•ï¼šupdate/modify/change + åè¯
    public User updateUserProfile(Long userId, UserProfile profile) { }
    public void modifyUserStatus(Long userId, UserStatus status) { }
    public void changeUserPassword(Long userId, String newPassword) { }
    
    // åˆ é™¤æ–¹æ³•ï¼šdelete/remove + åè¯
    public void deleteUser(Long userId) { }
    public void removeUserFromGroup(Long userId, Long groupId) { }
}
// [AI-BLOCK-END]
```

### 3. é¡¹ç›®ç»“æ„è§„èŒƒ (project-structure.mdc)

#### Mavené¡¹ç›®ç»“æ„ [MUST - L1]
```
project-name/
â”œâ”€â”€ pom.xml                                 # Mavené…ç½®æ–‡ä»¶
â”œâ”€â”€ README.md                              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ .gitignore                             # Gitå¿½ç•¥é…ç½®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/
â”‚   â”‚   â”‚   â””â”€â”€ com/company/project/       # åŒ…ç»“æ„ï¼šcom.å…¬å¸.é¡¹ç›®
â”‚   â”‚   â”‚       â”œâ”€â”€ Application.java       # Spring Bootå¯åŠ¨ç±»
â”‚   â”‚   â”‚       â”œâ”€â”€ config/                # é…ç½®ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ DatabaseConfig.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ RedisConfig.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ SecurityConfig.java
â”‚   â”‚   â”‚       â”œâ”€â”€ controller/            # æ§åˆ¶å™¨å±‚
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderController.java
â”‚   â”‚   â”‚       â”œâ”€â”€ service/               # æœåŠ¡å±‚
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserService.java
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ impl/              # æœåŠ¡å®ç°
â”‚   â”‚   â”‚       â”‚   â”‚   â””â”€â”€ UserServiceImpl.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderService.java
â”‚   â”‚   â”‚       â”œâ”€â”€ repository/            # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserRepository.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderRepository.java
â”‚   â”‚   â”‚       â”œâ”€â”€ entity/                # å®ä½“ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ Order.java
â”‚   â”‚   â”‚       â”œâ”€â”€ dto/                   # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ request/
â”‚   â”‚   â”‚       â”‚   â”‚   â””â”€â”€ CreateUserRequest.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ response/
â”‚   â”‚   â”‚       â”‚       â””â”€â”€ UserResponse.java
â”‚   â”‚   â”‚       â”œâ”€â”€ enums/                 # æšä¸¾ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ UserStatus.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ OrderStatus.java
â”‚   â”‚   â”‚       â”œâ”€â”€ exception/             # å¼‚å¸¸ç±»
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ BusinessException.java
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ GlobalExceptionHandler.java
â”‚   â”‚   â”‚       â””â”€â”€ util/                  # å·¥å…·ç±»
â”‚   â”‚   â”‚           â”œâ”€â”€ DateUtil.java
â”‚   â”‚   â”‚           â””â”€â”€ StringUtil.java
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.yml            # ä¸»é…ç½®æ–‡ä»¶
â”‚   â”‚       â”œâ”€â”€ application-dev.yml        # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ application-prod.yml       # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ logback-spring.xml         # æ—¥å¿—é…ç½®
â”‚   â”‚       â”œâ”€â”€ mapper/                    # MyBatisæ˜ å°„æ–‡ä»¶
â”‚   â”‚       â”‚   â””â”€â”€ UserMapper.xml
â”‚   â”‚       â””â”€â”€ static/                    # é™æ€èµ„æº
â”‚   â””â”€â”€ test/
â”‚       â”œâ”€â”€ java/
â”‚       â”‚   â””â”€â”€ com/company/project/
â”‚       â”‚       â”œâ”€â”€ controller/            # æ§åˆ¶å™¨æµ‹è¯•
â”‚       â”‚       â”œâ”€â”€ service/               # æœåŠ¡å±‚æµ‹è¯•
â”‚       â”‚       â””â”€â”€ repository/            # æ•°æ®è®¿é—®å±‚æµ‹è¯•
â”‚       â””â”€â”€ resources/
â”‚           â”œâ”€â”€ application-test.yml       # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚           â””â”€â”€ test-data/                 # æµ‹è¯•æ•°æ®
â””â”€â”€ docs/                                  # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ api/                               # APIæ–‡æ¡£
    â”œâ”€â”€ database/                          # æ•°æ®åº“æ–‡æ¡£
    â””â”€â”€ deployment/                        # éƒ¨ç½²æ–‡æ¡£
```

## ğŸ”§ éªŒè¯å·¥å…·é…ç½®

### CheckStyleé…ç½® [MUST - L1]
```xml
<?xml version="1.0"?>
<!DOCTYPE module PUBLIC
    "-//Checkstyle//DTD Checkstyle Configuration 1.3//EN"
    "https://checkstyle.org/dtds/configuration_1_3.dtd">

<module name="Checker">
    <property name="charset" value="UTF-8"/>
    <property name="severity" value="error"/>
    
    <!-- æ–‡ä»¶é•¿åº¦æ£€æŸ¥ -->
    <module name="FileLength">
        <property name="max" value="500"/>
    </module>
    
    <!-- è¡Œé•¿åº¦æ£€æŸ¥ -->
    <module name="LineLength">
        <property name="max" value="120"/>
        <property name="ignorePattern" value="^package.*|^import.*|a href|href|http://|https://|ftp://"/>
    </module>
    
    <module name="TreeWalker">
        <!-- å‘½åè§„èŒƒæ£€æŸ¥ -->
        <module name="ConstantName"/>
        <module name="LocalFinalVariableName"/>
        <module name="LocalVariableName"/>
        <module name="MemberName"/>
        <module name="MethodName"/>
        <module name="PackageName"/>
        <module name="ParameterName"/>
        <module name="StaticVariableName"/>
        <module name="TypeName"/>
        
        <!-- ä»£ç æ ¼å¼æ£€æŸ¥ -->
        <module name="Indentation">
            <property name="basicOffset" value="4"/>
        </module>
        <module name="LeftCurly"/>
        <module name="RightCurly"/>
        <module name="WhitespaceAfter"/>
        <module name="WhitespaceAround"/>
        
        <!-- æ–¹æ³•è®¾è®¡æ£€æŸ¥ -->
        <module name="ParameterNumber">
            <property name="max" value="5"/>
        </module>
        <module name="MethodLength">
            <property name="max" value="50"/>
        </module>
    </module>
</module>
```

### PMDè§„åˆ™é…ç½® [SHOULD - L2]
```xml
<?xml version="1.0"?>
<ruleset name="Custom Rules">
    <description>Custom PMD rules for Java development</description>
    
    <!-- æœ€ä½³å®è·µ -->
    <rule ref="category/java/bestpractices.xml">
        <exclude name="GuardLogStatement"/>
    </rule>
    
    <!-- ä»£ç é£æ ¼ -->
    <rule ref="category/java/codestyle.xml">
        <exclude name="AtLeastOneConstructor"/>
        <exclude name="OnlyOneReturn"/>
    </rule>
    
    <!-- è®¾è®¡è§„åˆ™ -->
    <rule ref="category/java/design.xml">
        <exclude name="LawOfDemeter"/>
    </rule>
    
    <!-- é”™è¯¯å€¾å‘ -->
    <rule ref="category/java/errorprone.xml"/>
    
    <!-- æ€§èƒ½è§„åˆ™ -->
    <rule ref="category/java/performance.xml"/>
</ruleset>
```

### SonarQubeè´¨é‡é—¨ç¦ [MUST - L1]
```yaml
# sonar-quality-gate.yml
quality_gate:
  name: "Javaé¡¹ç›®è´¨é‡é—¨ç¦"
  conditions:
    - metric: "new_coverage"
      operator: "LT"
      threshold: "80"
      error: true
    - metric: "new_duplicated_lines_density"
      operator: "GT"
      threshold: "3"
      error: true
    - metric: "new_maintainability_rating"
      operator: "GT"
      threshold: "1"
      error: true
    - metric: "new_reliability_rating"
      operator: "GT"
      threshold: "1"
      error: true
    - metric: "new_security_rating"
      operator: "GT"
      threshold: "1"
      error: true
```

## ğŸ“Š è§„èŒƒæ‰§è¡Œç›‘æ§

### ä»£ç è´¨é‡æŒ‡æ ‡ [MUST - L1]
```yaml
# code-quality-metrics.yml
metrics:
  coverage:
    line_coverage: ">= 80%"
    branch_coverage: ">= 70%"
    
  complexity:
    cyclomatic_complexity: "<= 10"
    cognitive_complexity: "<= 15"
    
  maintainability:
    technical_debt_ratio: "<= 5%"
    code_smells: "0 blocker, <= 5 critical"
    
  reliability:
    bugs: "0 blocker, 0 critical"
    
  security:
    vulnerabilities: "0 blocker, 0 critical"
    security_hotspots: "reviewed and resolved"
    
  duplication:
    duplicated_lines_density: "<= 3%"
```

### CI/CDé›†æˆæ£€æŸ¥ç‚¹ [MUST - L1]
```yaml
# .github/workflows/code-quality.yml
name: Code Quality Check
on: [push, pull_request]

jobs:
  code-quality:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Java
        uses: actions/setup-java@v3
        with:
          java-version: '8'
          
      - name: Run CheckStyle
        run: mvn checkstyle:check
        
      - name: Run PMD
        run: mvn pmd:check
        
      - name: Run SpotBugs
        run: mvn spotbugs:check
        
      - name: Run Tests with Coverage
        run: mvn clean test jacoco:report
        
      - name: SonarQube Analysis
        run: mvn sonar:sonar
        env:
          SONAR_TOKEN: ${{ secrets.SONAR_TOKEN }}
          
      - name: Quality Gate Check
        run: |
          # æ£€æŸ¥SonarQubeè´¨é‡é—¨ç¦çŠ¶æ€
          # å¦‚æœä¸é€šè¿‡ï¼Œæ„å»ºå¤±è´¥
```

---

*æ­¤è¯¦ç»†è§„èŒƒåŸºäºJavaç¼–ç¨‹è§„èŒƒä½“ç³»æ¦‚è§ˆï¼Œæä¾›å…·ä½“çš„å®æ–½ç»†èŠ‚å’ŒéªŒè¯æœºåˆ¶*
description:
globs:
alwaysApply: false
---
