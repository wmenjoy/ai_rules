> 编 号：
>
> 版 本 号 ：
>
> 受控状态：
>
> 密 级：
>
> **【组织名称】**
>
> **Python安全编码指南**
>
> **版权声明和保密须知**
>
> 本文件中出现的任何文字叙述、文档格式、插图、照片、方法、过程等内容，除另有特别注明，版权均属【组织名称】所有，受到有关产权及版权法保护。任何单位和个人未经【组织名称】的书面授权许可，不得复制或引用本文件的任何片断，无论通过电子形式或非电子形式。
>
> **Copyright © 2022【组织名称】 版权所有**
>
> 文档信息
>
> 文档编号：
>
> 文档分类：
>
> 编写：
>
> 审核：
>
> 批准：
>
> 初次发布日期：
>
> 生效日期：
>
> 修订日期：
>
> 版本记录
>
> **版本号**
>
> **版本日期**
>
> **修改**
>
> **审批人**
>
> **修改履历**
>
> 目 录
>
> TOC \\o \"1-3\" \\h \\u HYPERLINK \\l \"\_Toc207791539\"
> [1、前言]{.underline} PAGEREF \_Toc207791539 \\h 5
>
> HYPERLINK \\l \"\_Toc207791540\" [1.1目的]{.underline} PAGEREF
> \_Toc207791540 \\h 5
>
> HYPERLINK \\l \"\_Toc207791541\" [1.2适用范围]{.underline} PAGEREF
> \_Toc207791541 \\h 5
>
> HYPERLINK \\l \"\_Toc207791542\" [2、通用安全编码规范]{.underline}
> PAGEREF \_Toc207791542 \\h 5
>
> HYPERLINK \\l \"\_Toc207791543\" [2.1代码权限控制]{.underline} PAGEREF
> \_Toc207791543 \\h 5
>
> HYPERLINK \\l \"\_Toc207791544\" [2.2敏感信息保护]{.underline} PAGEREF
> \_Toc207791544 \\h 5
>
> HYPERLINK \\l \"\_Toc207791545\" [2.3第三方库管理]{.underline} PAGEREF
> \_Toc207791545 \\h 6
>
> HYPERLINK \\l \"\_Toc207791546\" [3、输入验证与过滤规范]{.underline}
> PAGEREF \_Toc207791546 \\h 6
>
> HYPERLINK \\l \"\_Toc207791547\" [3.1所有用户输入必须验证]{.underline}
> PAGEREF \_Toc207791547 \\h 6
>
> HYPERLINK \\l \"\_Toc207791548\" [3.2特殊字符过滤与转义]{.underline}
> PAGEREF \_Toc207791548 \\h 7
>
> HYPERLINK \\l \"\_Toc207791549\" [4、密码安全处理规范]{.underline}
> PAGEREF \_Toc207791549 \\h 8
>
> HYPERLINK \\l \"\_Toc207791550\" [4.1]{.underline}
> [密码存储禁止明文]{.underline} PAGEREF \_Toc207791550 \\h 9
>
> HYPERLINK \\l \"\_Toc207791551\" [4.2]{.underline}
> [密码传输加密]{.underline} PAGEREF \_Toc207791551 \\h 9
>
> HYPERLINK \\l \"\_Toc207791552\" [5、文件操作安全规范]{.underline}
> PAGEREF \_Toc207791552 \\h 10
>
> HYPERLINK \\l \"\_Toc207791553\" [5.1]{.underline}
> [限制文件操作范围]{.underline} PAGEREF \_Toc207791553 \\h 10
>
> HYPERLINK \\l \"\_Toc207791554\" [5.2]{.underline}
> [文件上传安全控制]{.underline} PAGEREF \_Toc207791554 \\h 11
>
> HYPERLINK \\l \"\_Toc207791555\" [6、错误处理与日志规范]{.underline}
> PAGEREF \_Toc207791555 \\h 12
>
> HYPERLINK \\l \"\_Toc207791556\" [6.1禁止暴露敏感错误信息]{.underline}
> PAGEREF \_Toc207791556 \\h 12
>
> HYPERLINK \\l \"\_Toc207791557\" [6.2安全日志记录]{.underline} PAGEREF
> \_Toc207791557 \\h 13
>
> HYPERLINK \\l \"\_Toc207791558\" [7、执行与监督]{.underline} PAGEREF
> \_Toc207791558 \\h 14
>
> HYPERLINK \\l \"\_Toc207791559\" [7.1代码审查要求]{.underline} PAGEREF
> \_Toc207791559 \\h 14
>
> HYPERLINK \\l \"\_Toc207791560\" [7.2定期安全测试]{.underline} PAGEREF
> \_Toc207791560 \\h 14
>
> HYPERLINK \\l \"\_Toc207791561\" [7.3培训与更新]{.underline} PAGEREF
> \_Toc207791561 \\h 15
>
> HYPERLINK \\l \"\_Toc207791562\" [8、附录]{.underline} PAGEREF
> \_Toc207791562 \\h 15
>
> HYPERLINK \\l \"\_Toc207791563\" [8.1 常用 Python
> 安全库清单]{.underline} PAGEREF \_Toc207791563 \\h 15
>
> HYPERLINK \\l \"\_Toc207791564\" [8.2 Python
> 安全编码检查工具]{.underline} PAGEREF \_Toc207791564 \\h 15
>
> **前言**
>
> **1.1目的**
>
> 为规范公司 Python
> 开发人员的编码行为，降低因编码不规范导致的安全漏洞（如 SQL 注入、XSS
> 攻击、密码泄露等）风险，保障公司软件产品的安全性、稳定性及用户数据安全，特制定本指南。
>
> **1.2适用范围**
>
> 本指南适用于公司所有使用 Python 进行开发的项目，包括但不限于 Web
> 应用、桌面应用、大数据处理系统、接口服务等；适用于所有 Python
> 开发人员（含初级、中级、高级开发工程师）及代码审查人员。
>
> **2、通用安全编码规范**
>
> **2.1代码权限控制**
>
> 禁止使用root或高权限账号运行 Python
> 程序，应创建专用低权限运行账号，限制程序对系统资源（文件、进程、网络）的访问范围。
>
> 示例：
>
> **2.2敏感信息保护**
>
> 禁止在代码中硬编码敏感信息（如数据库密码、API
> 密钥、Token、服务器地址等），应通过环境变量、配置文件（加密存储）或专业密钥管理工具（如
> Vault）获取。
>
> 示例：

**2.3第三方库管理**

> 使用pip安装第三方库时，需指定明确版本号，避免因库版本更新引入兼容性或安全漏洞；定期使用pip-audit或safety工具扫描已安装库的安全漏洞。
>
> 示例：
>
> **3、输入验证与过滤规范**
>
> **3.1所有用户输入必须验证**
>
> 对用户输入（如 Web 表单提交、API
> 参数、命令行参数、文件上传内容等）进行严格验证，包括数据类型、长度、格式、取值范围等，禁止直接使用未验证的输入。
>
> 示例：
>
> **3.2特殊字符过滤与转义**
>
> 针对不同输出场景（如 HTML 页面渲染、SQL
> 查询、命令执行），对用户输入中的特殊字符（如\<、\>、\'、\"、;、\|等）进行对应转义，防止
> XSS、SQL 注入、命令注入攻击。
>
> 示例（SQL 查询转义，使用参数化查询）：
>
> 示例（HTML 页面渲染转义，防止 XSS）：
>
> **4、密码安全处理规范**
>
> **密码存储禁止明文**
>
> 禁止将用户密码明文存储在数据库或配置文件中，必须使用加密强度高的哈希算法（如
> bcrypt、Argon2、PBKDF2）对密码进行哈希处理，且每个密码需添加随机
> "盐值"（Salt）。
>
> 示例（使用 bcrypt 哈希密码）：
>
> **密码传输加密**
>
> 用户密码在网络传输过程中（如登录请求、密码修改），必须使用 HTTPS
> 协议加密传输，禁止使用 HTTP 明文传输。
>
> 示例（Flask 项目配置 HTTPS）：
>
> **5、文件操作安全规范**
>
> **限制文件操作范围**
>
> 禁止程序对系统根目录或敏感目录（如/etc、/home、C:\\Windows）进行无限制文件读写，需明确指定允许操作的文件目录（白名单），防止路径遍历攻击。
>
> 示例：
>
> **文件上传安全控制**
>
> 对用户上传文件进行严格校验：限制文件类型（通过文件头校验，而非仅依赖后缀名）、限制文件大小、扫描文件是否含恶意代码（如使用
> ClamAV）；禁止将上传文件直接存储在 Web 可访问目录。
>
> 示例：
>
> **6、错误处理与日志规范**
>
> **6.1禁止暴露敏感错误信息**
>
> 生产环境中，禁止向用户暴露 Python
> 异常堆栈信息、数据库结构、服务器路径等敏感信息，需自定义友好的错误提示；异常信息仅记录到日志中，不返回给客户端。
>
> 示例：
>
> **6.2安全日志记录**
>
> 记录关键安全事件日志，包括用户登录（成功 /
> 失败）、权限变更、敏感操作（如密码修改、数据删除）、异常请求（如多次登录失败、非法文件上传）等，日志需包含时间、操作人、操作
> IP、操作内容、结果等信息，便于后续安全审计与溯源。
>
> 示例：
>
> **7、执行与监督**
>
> **7.1代码审查要求**
>
> 所有 Python
> 代码提交前，需通过代码审查，审查重点包括本指南中涉及的安全编码规范（如敏感信息硬编码、输入验证、密码处理、SQL
> 注入防护等）；代码审查人员需依据本指南制定审查清单，确保无安全漏洞后，方可合并代码。
>
> **7.2定期安全测试**
>
> 开发团队需每季度对 Python
> 项目进行安全测试，包括静态代码扫描（使用工具如
> Bandit、Pylint-security）、动态渗透测试（模拟黑客攻击）；测试结果需形成报告，针对发现的安全漏洞制定修复计划，限期整改。
>
> **7.3培训与更新**
>
> 公司每年组织至少 2 次 Python 安全编码培训，解读本指南及最新 Python
> 安全漏洞案例；技术部门需关注 Python
> 官方安全公告（如https://www.python.org/security/）及第三方库安全动态，及时更新本指南内容。
>
> **8、附录**
>
> **8.1 常用 Python 安全库清单**
>
> 库名称
>
> 用途
>
> 安装命令
>
> bcrypt

密码哈希处理

pip install bcrypt

> python-magic

文件类型校验（读取文件头）

pip install python-magic

> markupsafe

HTML 特殊字符转义（防止 XSS）

pip install markupsafe

> sqlalchemy

ORM 框架（内置 SQL 注入防护）

pip install sqlalchemy

> requests

HTTP 请求（支持 HTTPS，安全传输）

pip install requests

> **8.2 Python 安全编码检查工具**
>
> 工具名称
>
> 用途
>
> 使用命令
>
> Bandit

静态代码安全扫描（检测 SQL 注入、XSS、密码硬编码等）

pip install bandit; bandit -r 项目目录 /

> pip-audit

第三方库漏洞扫描

pip install pip-audit; pip-audit

> Pylint-security

Pylint 插件，增强代码安全检查

pip install pylint-security; pylint \--load-plugins=pylint_security
项目目录 /

> PAGE 1
>
> 34
>
> 第
>
> 共
>
> 页
>
> PAGE 24
>
> 34
>
> 第
>
> 页
>
> 共
>
> 页
