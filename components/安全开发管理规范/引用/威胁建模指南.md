编号：

版本号：

受控状态：

密级：

【组织名称】威胁建模指南

**版权声明和保密须知**

本文件中出现的任何文字叙述、文档格式、插图、照片、方法、过程等内容，除另有特别注明，版权均属【组织名称】所有，受到有关产权及版权法保护。任何单位和个人未经【组织名称】的书面授权许可，不得复制或引用本文件的任何片断，无论通过电子形式或非电子形式。

**Copyright@2025【组织名称】 版权所有**

文档信息

  ------------------------------------------------------------------------
  文档编号：                              文档分类：
  --------------------- ----------------- --------------------------------
  编写：                审核：            批准：

  初次发布日期：        生效日期：        修订日期：
  ------------------------------------------------------------------------

版本记录

  -----------------------------------------------------------------------
   **版本号**    **版本日期**    **修改**    **审批人**      **备注**
  ------------- --------------- ----------- ------------- ---------------
                                                          

                                                          

                                                          

                                                          

                                                          

                                                          

                                                          

                                                          
  -----------------------------------------------------------------------

# 目录 {#目录 .TOC-Heading}

[一、目的 [3](#一目的)](#一目的)

[二、适用对象 [3](#二适用对象)](#二适用对象)

[三、STRIDE威胁建模介绍
[4](#三stride威胁建模介绍)](#三stride威胁建模介绍)

[四、STRIDE威胁建模流程
[7](#四stride威胁建模流程)](#四stride威胁建模流程)

> [（一）确定安全目标与分解应用程序阶段
> [7](#一确定安全目标与分解应用程序阶段)](#一确定安全目标与分解应用程序阶段)
>
> [（二）识别关键风险点与确定威胁列表阶段
> [7](#二识别关键风险点与确定威胁列表阶段)](#二识别关键风险点与确定威胁列表阶段)
>
> [（三）建模分析阶段 [8](#三建模分析阶段)](#三建模分析阶段)
>
> [（四）风险评估阶段 [10](#四风险评估阶段)](#四风险评估阶段)
>
> [（五）方案落地阶段 [10](#五方案落地阶段)](#五方案落地阶段)

[五、威胁建模常用工具 [11](#五威胁建模常用工具)](#五威胁建模常用工具)

# 一、目的

随着公司数字化业务的深度拓展，业务系统与外部生态的关联性不断增强，潜在安全威胁呈现多样化、隐蔽化趋势。威胁建模是信息安全体系中"主动防御"的关键环节，通过系统化梳理系统面临的威胁、攻击路径及潜在风险，将安全防护从"事后补救"转向"事前预防"。其作用与目的围绕"识别风险、指导防护、优化设计"展开，最终为业务系统构建更精准、更稳健的安全防线。

本规范旨在建立标准化的威胁建模工作机制，通过结构化方法系统识别业务系统、数据流转及技术架构中的潜在威胁，量化威胁风险等级，为安全设计、漏洞修复及防护策略制定提供精准依据。

# 二、适用对象

**1.
新建系统设计阶段：**适用于公司自主研发或第三方合作开发的全新业务系统（如客户服务平台、智能交易系统），需在系统架构设计方案确定后、编码开发启动前完成首次威胁建模，形成威胁分析报告并纳入设计评审标准。

**2.
现有系统重大迭代阶段：**当现有系统进行核心功能升级（如支付流程优化、数据交互模式变更）、技术架构调整（如从单体架构迁移至微服务架构）或接入新外部系统（如第三方支付接口、数据共享平台）时，需同步开展威胁建模，评估迭代内容引入的新威胁。

**3.
高风险系统定期复盘阶段：**针对承载核心业务（如财务结算系统、用户身份认证系统）或存储敏感数据（如客户个人信息、商业机密）的高风险系统，需每季度开展一次威胁建模复盘，结合最新安全漏洞情报（如
CVE 新增漏洞、行业攻击案例）更新威胁清单与防护措施。

# 三、STRIDE威胁建模介绍

STRIDE
模型是由微软提出的经典威胁建模框架，通过将威胁划分为六大核心类型，帮助团队系统化识别系统面临的安全风险，其核心逻辑是围绕
"攻击者可能通过何种方式破坏系统安全性"展开，每种威胁类型对应特定的安全属性破坏目标。STRIDE
模型包含六大威胁类型：

1.  **欺骗（Spoofing）**

指攻击者伪造合法身份或凭证，获取未授权访问权限的威胁类型，核心是
"冒充信任主体"。常见场景包括：伪造用户登录令牌登录系统、仿冒公司官网域名制作钓鱼网站骗取用户账号密码、伪造服务器证书实施中间人攻击。此类威胁会破坏系统的
"身份认证"
安全属性，可能导致攻击者以合法用户或系统组件身份操作敏感功能。

2.  **篡改（Tampering）**

指攻击者未经授权修改数据、代码或配置信息，破坏数据完整性或系统可用性的威胁类型，核心是
"改变关键信息内容"。常见场景包括：修改数据库中的交易金额、篡改传输过程中的用户订单数据、恶意修改服务器配置文件导致系统故障。此类威胁会破坏系统的
"数据完整性" 与 "系统可用性"
安全属性，可能引发业务逻辑混乱、财务损失或系统停运。

3.  **否认（Repudiation）**

指攻击者实施恶意操作后，通过删除日志、伪造操作记录等方式，逃避责任追溯的威胁类型，核心是
"无法证明操作归属"。常见场景包括：删除系统操作日志掩盖数据窃取行为、使用匿名账号发起攻击且无审计记录、伪造他人操作记录嫁祸合法用户。此类威胁会破坏系统的
"不可否认性"
安全属性，导致安全事件发生后无法定位责任人，增加事件处置难度。

4.  **信息泄露（Information Disclosure）**

指攻击者未授权获取敏感信息并泄露的威胁类型，核心是
"敏感数据未受控暴露"。常见场景包括：通过 SQL
注入漏洞读取数据库中的客户身份证信息、利用 API
接口权限漏洞下载核心业务报表、窃取未加密的备份数据文件。此类威胁会破坏系统的
"数据保密性"
安全属性，可能导致客户隐私泄露、商业机密外泄，引发法律风险与品牌声誉损失。

5.  **拒绝服务（Denial of Service，DoS/DDoS）**

指攻击者通过占用系统资源（如带宽、CPU、内存）或触发系统漏洞，导致合法用户无法正常使用服务的威胁类型，核心是
"耗尽关键资源"。常见场景包括：发起 DDoS
攻击占用服务器带宽、发送大量无效请求耗尽数据库连接池、利用系统漏洞触发死循环导致服务器崩溃。此类威胁会破坏系统的
"可用性"
安全属性，可能导致业务中断（如电商平台无法下单、支付系统无法结算），造成直接经济损失。

6.  **权限提升（Elevation of Privilege）**

指攻击者从低权限状态获取更高权限（如普通用户获取管理员权限），扩大攻击范围的威胁类型，核心是
"突破权限边界"。常见场景包括：利用操作系统漏洞提升账号权限、通过应用程序漏洞获取服务器
root
权限、利用权限配置漏洞操作超出自身职责范围的功能。此类威胁会破坏系统的
"访问控制"
安全属性，攻击者获取高权限后可能全面控制系统，造成更严重的安全后果。

# 四、STRIDE威胁建模流程

## （一）确定安全目标与分解应用程序阶段

**1.
确定安全目标：**结合系统业务属性、数据敏感级别及合规要求，明确系统需达成的安全目标，安全目标需遵循
"具体、可衡量、可实现、相关性、时限性"（SMART）原则。

**2.
分解应用程序：**按照"从整体到局部、从功能到组件"的逻辑，将应用程序拆解为可独立分析的单元，明确各单元的功能、数据流转关系及依赖组件，为后续威胁识别奠定基础。分解维度包括但不限于：

a)  功能模块分解：将应用程序按核心功能拆分为子模块，如客户 APP
    可拆解为登录模块、商品浏览模块、下单支付模块、个人中心模块。

b)  技术组件分解：针对每个功能模块，进一步拆解为底层技术组件，如登录模块可拆解为用户输入组件、身份验证组件、令牌生成组件、日志记录组件。

c)  数据流转分解：梳理每个组件间的数据交互关系，如
    "用户输入组件→身份验证组件"
    传输用户账号密码数据，"身份验证组件→令牌生成组件" 传输验证结果数据。

## （二）识别关键风险点与确定威胁列表阶段

**1.
识别关键风险点：**基于应用程序分解结果、安全目标及行业攻击案例，从"业务流程风险""技术组件风险""数据流转风险"三个维度识别关键风险点，关键风险点需满足
"可能导致安全目标失效""发生概率较高或影响程度较大"两个条件。识别方法：包括但不限于：

a)  业务流程风险识别：梳理核心业务流程（如用户注册→登录→下单→支付），分析每个环节可能存在的风险，如
    "下单环节未校验用户账户余额，可能导致超支交易""支付环节未与银行系统实时对账，可能导致交易金额篡改"。

b)  技术组件风险识别：针对分解后的技术组件，结合组件特性与已知漏洞，识别风险点，如"身份验证组件使用弱哈希算法存储密码，可能导致密码被破解""令牌生成组件未设置令牌过期时间，可能导致令牌被长期滥用"。

c)  数据流转风险识别：检查数据在组件间、系统间的流转过程，识别风险点，如
    "用户手机号从 APP
    传输至后台时使用明文传输，可能被拦截泄露""订单数据从交易系统同步至财务系统时未加密，可能被篡改"。

**2. 确定威胁列表：**结合 STRIDE
威胁类型与关键风险点，匹配每个风险点对应的具体威胁，形成结构化的威胁列表，明确威胁的具体表现形式与攻击路径。

## （三）建模分析阶段

**1.
绘制数据流图（DFD）：**基于应用程序分解结果与数据流转关系，专项团队绘制详细的数据流图，明确核心组件（如客户端、应用服务器、数据库、第三方服务）、数据流向（如用户登录请求→应用服务器→数据库验证）及信任边界（如客户端与应用服务器之间的网络边界、内部系统与第三方服务之间的接口边界），确保覆盖所有关键业务流程与数据交互环节，数据流图需标注与威胁列表中威胁相关的组件与数据流。

**2. 关联威胁列表与 STRIDE
模型：**针对数据流图中的每个组件、数据流向与信任边界，关联《威胁列表》中的威胁，结合
STRIDE 模型进一步补充威胁细节，例如：针对 "用户登录数据传输"
数据流，关联威胁列表中 "明文传输导致信息泄露" 的威胁，补充 STRIDE
"信息泄露" 类型的特征描述，明确该威胁破坏的 "数据保密性" 安全属性。

**3.
完善威胁详情记录：**在原有《威胁清单表》基础上，补充关联的关键风险点
ID、应用程序组件、攻击前提条件等信息，形成更完整的威胁记录，例如：威胁
ID（STRIDE-2024-001）、威胁类型（欺骗）、关联风险点
ID（RISK-2024-003）、涉及组件（令牌生成组件）、威胁描述（攻击者可通过伪造
JWT 令牌登录系统）、攻击路径（获取合法用户 JWT 令牌→修改令牌中的用户
ID→发送登录请求）、攻击前提条件（获取 JWT
令牌生成算法）、关联安全属性（身份认证），确保威胁信息可追溯、可分析。

## （四）风险评估阶段

**1.
制定风险评估标准：**参考公司《信息安全风险评估管理办法》，制定威胁风险评估标准，从
"威胁发生可能性" 与 "威胁影响程度"两个维度进行评分，其中：

a)  发生可能性：结合漏洞存在概率（如是否使用存在已知漏洞的组件）、攻击者技术门槛（如是否需专业黑客技术）、系统暴露程度（如是否面向公网）评分；

b)  影响程度：结合数据敏感级别（如核心商业数据、普通运营数据）、业务中断损失（如每小时停运损失金额）、法律合规风险（如是否违反《个人信息保护法》）评分。

**2. 确定优先处理顺序**：按照 "高风险优先、业务核心优先"
原则，确定威胁处理顺序，高风险威胁需 100%
纳入优先修复清单，中风险威胁根据开发资源情况选择性优先处理，低风险威胁可纳入长期优化计划。同时，结合关键风险点的重要性，对同一风险等级的威胁，优先处理关联核心业务风险点（如交易风险点）的威胁。

## （五）方案落地阶段

**1.
制定威胁修复方案：**专项团队针对高、中风险威胁，制定具体修复方案，明确修复措施、责任部门、完成时限。修复方案需关联关键风险点与安全目标，确保修复后可消除风险点、达成安全目标。

# 五、威胁建模常用工具

为提高企业威胁建模的效率和准确性，以下是几款常用的威胁建模工具：

1.  **Microsoft Threat Modeling Tool：**该工具由微软开发，基于 STRIDE
    模型，操作简单直观，适合初学者使用。它能够帮助用户快速构建系统模型，自动识别潜在威胁，并生成威胁分析报告，支持导出报告为
    Word、Excel 等格式，方便企业进行后续的分析和管理工作。​

<!-- -->

2.  **OWASP Threat
    Dragon：**这是一款开源的威胁建模工具，支持基于攻击树和 STRIDE
    模型的威胁识别方法。它具有跨平台特性，可在 Windows、Linux、Mac
    等操作系统上运行，用户可以根据自身需求自定义威胁模型和威胁库，同时支持团队协作，多个团队成员可以共同参与威胁建模工作，提高工作效率。​
