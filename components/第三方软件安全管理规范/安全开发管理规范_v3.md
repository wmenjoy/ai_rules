-------------- ------------------------------ -------------- -----------------
    **文 号**                                   **密 级**      ⬜公开 ☑内部

   **主责部门**  质量管理部                     **制度状态**   ⬜制定 ⬜修订

   **制度等级**  ⬜基本管理制度 ☑公司规章                      
                 ⬜业务规范                                    

   **生效日期**  年 月 日                                      
-------------- ------------------------------ -------------- -----------------

北京数字认证股份有限公司

安全开发管理规范

# 第一章 总则（袁培茹） {#第一章-总则袁培茹 .样式1}

**第一条**
为了规范软件开发生命周期各阶段的安全实现要求，构建安全可高的软件产品，降低安全债务和安全漏洞，提高产品安全性，根据《可信研发运营安全能力成熟度模型》、《软件安全开发能力评估技术规范》，结合公司实际情况，特制定本规范。

**第二条**
本规范适用于公司所有自研产品软件开发、产品定制开发、组件及平台开发等，涵盖软件开发生命周期全部活动。

**第三条** 应遵守如下原则：

（一）安全人人有责：产品安全不仅仅是安全团队或测试团队的事情，而是产品、研发、测试等全部人员共同的职责，需要根据公司要求严格落实各项安全工作。

（二）安全左移尽早开始：安全活动需要尽早开始与开发生命周期同步，从源头明确目标，避免安全漏洞引入。

（三）合规是底线：满足法律法规和标准是必须遵守的底线，组织的安全目标应远高于合规要求。

（四）持续改进和提高：安全不是一次性的工作，需要持续不断的提升和改进，从技术使用、三方软件、依赖环境等，需要持续进行跟进改进。

# 第二章 工作职责（袁培茹） {#第二章-工作职责袁培茹 .样式1}

**第四条
网络安全与数字化领导小组：**负责审核和批准安全开发的策略和安全基线、安全管理相关机制，对于开发安全重大事件组织制定方案和推进有效解决。

**第五条
产品研发部门：**负责所属产品的安全目标制定，需求、设计和开发的安全要求执行落地，对产品的整体安全质量负责，推进安全持续改进，降低安全债务和安全漏洞。

**第六条
测试部门：**负责根据产品的安全目标组织进行测试验证（包括内部和第三方验证）制定安全测试相关要求和落地执行；对验证工具进行选型和持续维护更新，对内部安全测试验证的质量负责。

**第七条
配置管理部门：**负责根据安全发布的要求落实配置管理和持续构建以及打包安全要求，对于安全发布质量进行负责。

**第八条
漏洞管理部门：**负责根据安全漏洞管理要求落实安全漏洞管理，包括漏洞的监控、预警、漏洞修复监控等。（暂时放在测试二部
配置管理员兼任）

**第九条
质量管理部：**负责组织安全管理机制的建立和推进落实，监督安全机制的落实，并针对于安全执行情况进行考核和上报，推进安全工作有效开展。

# 第三章 产品安全基线（孟然） {#第三章-产品安全基线孟然 .样式1}

**第十条 安全基线定义与目标**

产品安全基线是公司为所有软件产品设定的强制性最低安全标准，用于确保产品在发布前具备基本的安全能力，防止因配置不当、设计缺陷、组件漏洞等引发安全风险，所有产品必须满足基线要求方可进入测试和发布阶段。

**第十一条 适用范围**

适用于公司所有自研软件产品，包括但不限于：

- Web应用系统

- 移动应用（移动端H5/小程序/iOS/Android/HarmonyOS）

- 桌面客户端

- 中间件/服务组件

- 嵌入式系统

**第十二条 身份认证与访问控制基线**

**（一）身份认证要求**

1.  多因素认证：管理后台、重要业务系统必须支持多因素认证，至少包含密码+动态验证码或密码+生物特征等组合方式。

2.  账号及密码策略：

- 系统管理账号密码策略密码长度不少于15位，至少包括大写字母、小写字母、特殊字符、数字，且不能出现3个（含）及以上的顺序字符（如123、abc、ABC等）。

- 最终用户账号密码策略由最终用户注册、管理的账号密码长度不少于10位，至少包括大写字母、小写字母、特殊字符、数字，且不能出现3个（含）及以上的顺序字符（如123、abc）。

- 禁止使用弱口令、空口令或已泄露的口令

- 密码必须加密存储，使用SHA-256、国密SM3等不可逆算法，并添加随机盐值

- 密码定期更换周期不超过90天

- 设置账号登录失败锁定机制，如密码失败5次锁定5分钟

- 系统管理账号、最终用户账号尽可能避免使用通用账号，且禁止使用通用账号注册，如admin、root、user、guest、game,
  username, test, test111, test123, administrator, demo等

3.  会话管理：

- 会话标识符必须具有足够的随机性

- 设置合理的会话超时时间，一般不超过30分钟

- 登录成功后重新生成会话标识符

- 支持并发登录控制和账户锁定机制

  **（二）访问控制要求**

1.  最小权限原则：用户和系统账户仅具有执行经授权任务所需的最小权限。

2.  权限分离：关键操作需要权限分离，如系统管理、审计管理、业务操作等角色必须分离。

3.  访问控制模型：采用基于角色的访问控制（RBAC）或基于属性的访问控制（ABAC）模型。

4.  敏感数据访问：对敏感数据的访问必须有明确的授权和完整的审计日志。

**第十三条 数据安全基线**

**（一）数据分类与标记**

1.  建立数据分类分级制度，将数据分为：公开、内部、机密、绝密四个等级

2.  对不同等级的数据采取相应的保护措施

3.  敏感数据必须进行明确标记

    **（二）数据加密要求**

<!-- -->

1.  传输加密：所有敏感数据在网络传输过程中必须使用TLS 1.2以上版本加密

2.  存储加密：重要敏感数据在存储时必须加密，可采用AES、国密SM4等算法

3.  密钥管理：建立安全的密钥管理机制，确保密钥的安全生成、分发、存储和销毁

    **（三）数据脱敏**

<!-- -->

1.  开发测试环境严禁使用生产环境的真实敏感数据

2.  需要展示敏感信息时，必须进行脱敏处理

3.  日志中禁止记录完整的敏感信息

**第十四条 输入验证基线**

1.  统一验证：所有外部输入数据必须进行安全性验证

2.  验证内容：包括数据类型、长度、格式、取值范围等

3.  白名单验证：优先使用白名单方式验证输入数据

4.  特殊字符处理：对特殊字符进行过滤或转义处理

**第十五条 日志与审计基线**

**（一）日志记录要求**

1.  记录内容：记录用户登录、重要操作、安全事件等关键行为

2.  日志要素：包含时间戳、用户标识、IP地址、操作描述、操作结果等

3.  日志保护：防止日志被篡改或删除

4.  日志保留：安全日志保留时间不少于6个月

    **（二）审计要求**

<!-- -->

1.  定期审计系统和应用程序日志

2.  建立异常行为检测机制

3.  对审计发现的问题及时处理

**第十六条 安全配置基线**

**（一）系统安全配置**

1.  关闭不必要的服务和端口

2.  删除默认账户或修改默认密码

3.  启用系统安全审计功能

4.  及时安装安全补丁

    **（二）应用安全配置**

<!-- -->

1.  禁用调试模式

2.  配置安全的错误处理机制

3.  设置安全的HTTP响应头

4.  配置跨域资源共享（CORS）安全策略

**第十七条 第三方组件安全基线**

本基线为第三方软件（组件）在引入、使用和管理过程中的最低安全要求。

**（一）范围定义**

本规范所指的第三方软件包括但不限于：
1.  **产品研发组件**：研发过程中使用的开源组件、第三方库、框架等。
2.  **开发工具**：开发、构建、测试、部署等环节使用的各类工具软件。
3.  **基础软件**：运行时依赖的中间件、数据库、操作系统、容器引擎等。
4.  **商业软件**：通过商业采购获得的软件产品及服务。

**（二）风险评估与准入**

1.  **风险等级定义**：所有第三方软件在引入前必须进行风险评估，并划分为以下等级：
    -   **低风险**：无已知公开高危漏洞（CVSS < 7.0），采用宽松型许可证（如 MIT, Apache 2.0），社区活跃。
    -   **中风险**：存在中危漏洞（CVSS 4.0-6.9），或采用限制型许可证（如 LGPL），需评估合规要求。
    -   **高风险**：存在高危漏洞（CVSS >= 7.0），或采用强传染性许可证（如 GPL, AGPL）。
    -   **禁止使用**：存在已被利用的严重漏洞且无修复方案，许可证与商业模式冲突，或来源不明。

2.  **准入要求**：
    -   高风险、禁止使用的软件原则上不得引入。
    -   中风险软件需经技术负责人审批，并明确风险缓解措施。

**（三）版本管理**

1.  **版本年龄**：
    -   新引入的第三方软件，其发布时间距今不应超过 **1年**。
    -   已在系统中使用的第三方软件，其发布时间距今不应超过 **2年**。超期服役需提交专项风险评估报告。
2.  **版本选择**：
    -   优先选择官方推荐的 **长期支持（LTS）版本**。
    -   禁止在生产环境中使用任何 **Alpha、Beta、SNAPSHOT** 或已停止维护的版本。

**（四）许可证合规**

1.  **许可证分类**：
    -   **推荐使用（白名单）**：MIT, Apache 2.0, BSD 等。
    -   **限制使用（灰名单）**：LGPL, MPL 等。使用前需法务评估。
    -   **禁止使用（黑名单）**：GPL, AGPL 等。原则上禁止在商业闭源产品中使用。
2.  **合规义务**：
    -   在产品文档中必须包含 `NOTICE` 文件，声明所有第三方组件及其许可证。
    -   如使用 LGPL 等组件，需履行相应的源码开放义务。

**（五）漏洞管理与响应**

1.  **漏洞扫描**：
    -   所有第三方软件在引入前必须经过 **软件成分分析** 扫描。
    -   CI/CD流水线必须集成自动化软件成分分析，阻断存在严重漏洞的构建。
2.  **漏洞修复时限**：
    -   **严重漏洞 (Critical, 9.0-10.0)**：**7天** 内修复。
    -   **高危漏洞 (High, 7.0-8.9)**：**30天** 内修复。
    -   **中危漏洞 (Medium, 4.0-6.9)**：**90天** 内修复。
    -   **低危漏洞 (Low, 0.1-3.9)**：纳入常规迭代计划。

**（六）代码纯净性**

1.  **信息保留**：引入第三方代码时，必须完整保留其原始版权、许可证和作者信息。
2.  **修改明示**：任何对第三方代码的修改都必须添加明确注释，说明修改内容和原因。

# 第四章 安全开发（孟然） {#第四章-安全开发孟然 .样式1}

**第十八条 安全开发定义**

安全开发是将安全要素融入到软件开发生命周期的各个阶段，从需求分析、设计、编码到测试和发布，确保安全性贯穿整个开发过程。本章规定了安全需求、安全设计、安全开发三个方面的具体要求。

**第十九条 安全需求分析**

安全需求分析是安全开发的起点，旨在识别和定义产品的安全要求，为后续的安全设计和实现提供依据。

**（一）安全需求识别**

1.  客户安全要求：

- 收集和分析客户对系统安全的具体要求

- 明确客户的安全期望和合规要求

- 记录客户的安全约束条件

2.  法律法规要求：

- 识别适用的法律法规要求，如《网络安全法》、《数据安全法》等

- 分析行业标准和技术规范的安全要求

- 确保产品符合监管要求

3.  用户隐私需求：

- 识别产品处理的用户个人信息

- 分析个人信息处理的合法性和必要性

- 制定个人信息保护措施

4.  威胁分析：

- 识别系统面临的潜在安全威胁

- 分析威胁的可能性和影响程度

- 制定相应的防护策略

  **（二）安全需求文档化**

1.  将安全需求写入产品需求规格说明书

2.  明确安全需求的验收标准

3.  确保安全需求可测试、可验证

4.  建立安全需求跟踪矩阵

    **最佳实践：**

    参考微软SDL的威胁建模方法，使用STRIDE模型（欺骗、篡改、否认、信息泄露、拒绝服务、权限提升）进行威胁分析。

**第二十条 安全设计**

安全设计是将安全需求转化为具体的设计方案，建立系统的安全架构，确保安全性在系统设计层面得到保障。

**（一）安全设计原则**

1.  最小权限原则：系统组件和用户仅拥有完成任务所需的最小权限

2.  纵深防御：采用多层次的安全防护措施，避免单点失效

3.  失败安全：系统在异常情况下默认进入安全状态

4.  开放设计：安全设计不依赖于保密性，而是基于密钥等可控因素

5.  职责分离：关键功能由多个组件协同完成，避免单点控制

6.  完全仲裁：每次访问都必须经过权限检查

    **（二）架构安全设计**

<!-- -->

1.  网络架构安全：

- 采用分层网络架构，隔离不同安全等级的系统

- 配置防火墙和访问控制策略

- 建立安全的通信通道

2.  应用架构安全：

- 采用模块化设计，降低组件间的耦合度

- 实现安全的API设计

- 配置安全的中间件和框架

3.  数据架构安全：

- 设计安全的数据存储结构

- 规划数据备份和恢复策略

- 建立数据分类分级存储机制

**第二十一条 安全编码**

安全编码是将安全设计转化为安全实现的关键环节，通过遵循安全编码规范，从源头上减少安全漏洞的产生。

**（一）安全编码规范**

1.  输入验证：

- 对所有外部输入进行验证，包括用户输入、文件输入、网络数据等

- 采用白名单验证方式，只允许合法的输入

- 验证数据类型、长度、格式和取值范围

- 对特殊字符进行过滤或转义

2.  SQL注入防护：

- 使用参数化查询或预编译语句

- 避免动态拼接SQL语句

- 限制数据库账户权限

- 对数据库错误信息进行统一处理

3.  跨站脚本（XSS）防护：

- 对输入数据进行过滤和编码

- 设置HttpOnly属性保护Cookie

- 启用内容安全策略（CSP）

- 避免使用危险的HTML标签和属性

  **（二）常见漏洞防护**

  -----------------------------------------------------------------------------
  **漏洞类型**       **防护要求**                         **检查方法**
  ------------------ ------------------------------------ ---------------------
  缓冲区溢出         • 使用安全的字符串处理函数\          代码审查、静态分析
                     • 进行边界检查\                      
                     • 使用内存安全的编程语言             

  注入攻击           • 使用参数化查询\                    代码审查、安全测试
                     • 输入验证和过滤\                    
                     • 最小权限原则                       

  不安全的反序列化   • 验证序列化数据完整性\              代码审查、渗透测试
                     • 限制反序列化类型\                  
                     • 使用安全的序列化格式               

  敏感信息泄露       • 加密存储敏感数据\                  配置检查、安全测试
                     • 安全的错误处理\                    
                     • 日志脱敏                           

  访问控制缺陷       • 实施严格的访问控制\                功能测试、渗透测试
                     • 服务器端验证\                      
                     • 防止权限提升                       
  -----------------------------------------------------------------------------

**（三）安全API使用**

1.  加密API：

- 使用标准的加密库和算法优先使用国密算法

- 避免自行实现加密算法

- 正确管理密钥和证书

2.  随机数生成：
- 使用密码学安全的随机数生成器

- 避免使用可预测的随机数种子

- 为每个会话生成独立的随机数

3.  文件操作：

- 验证文件路径，防止目录遍历

- 限制文件上传类型和大小

- 安全处理临时文件

  **（四）错误处理与日志记录**

1.  错误处理：

- 使用统一的错误处理机制

- 向用户展示通用的错误信息

- 记录详细的错误信息供调试使用

- 避免在错误信息中泄露敏感信息

2.  日志记录：

- 记录重要的安全事件

- 包含足够的信息用于审计

- 保护日志的完整性和机密性

- 定期归档和分析日志

**第二十二条 代码安全审查**

代码安全审查是发现代码中安全漏洞的重要手段，通过同行评审和工具分析相结合的方式，提高代码安全性。

**（一）审查流程**

1.  自测阶段：开发人员完成代码后进行自测，使用静态分析工具检查

2.  同行评审：由其他开发人员进行代码审查，重点关注安全相关问题

3.  安全专家审查：安全专家对关键代码进行专门审查

4.  问题跟踪：记录发现的安全问题，跟踪修复进度

    **（二）审查要点**

<!-- -->

1.  输入验证：是否对所有输入进行了验证和过滤

2.  认证授权：认证和授权逻辑是否正确实现

3.  加密使用：加密算法和密钥管理是否安全

4.  错误处理：错误处理是否安全，是否泄露敏感信息

5.  资源配置：配置文件和硬编码凭证是否安全

    **重要提醒：**

未经安全审查的代码不得合并到主分支，不得发布到生产环境。

**第二十三条 安全开发工具与环境**

**（一）开发环境安全**

1.  环境隔离：开发环境、测试环境、生产环境必须严格隔离

2.  访问控制：限制对开发环境的访问权限

3.  安全工具：配置安全的开发工具和插件

4.  代码保护：确保源代码仓库的安全性

    **（二）安全开发工具链**

<!-- -->

1.  静态分析工具：使用公司统一静态代码分析工具

2.  依赖检查：使用公司统一工具检查第三方组件漏洞

3.  容器安全：使用公司统一容器安全扫描工具检查镜像安全

4.  秘密扫描：使用公司统一工具防止敏感信息泄露

**第二十四条 统一开发环境与脚手架**

1.  开发框架标准化：强制使用公司指定的前后端脚手架及中间件，禁止随意使用其他开发框架及版本

2.  版本更新机制：建立定期评估和更新机制，及时跟进安全漏洞

3.  安全配置基线：为每种中间件制定统一的安全配置标准

**第二十五条 第三方软件备份与档案管理**

**（一）备份要求**

1.  **备份范围**：所有经批准引入的第三方软件（包括其特定版本）均需纳入备份管理。
2.  **备份机制**：
    *   **自动化备份**：对于通过包管理工具（Maven, npm, pip等）引入的组件，必须配置内部镜像源（如Nexus, Artifactory）并启用自动代理和缓存。
    *   **手动备份**：对于手动下载的软件（如开发工具、基础软件），需将其安装包及配置文件归档至指定的软件库。
3.  **完整性校验**：所有备份文件必须提供并校验其哈希值（SHA-256），确保文件在传输和存储过程中未被篡改。

**（二）档案管理**

1.  **软件档案**：为每个引入的第三方软件建立档案，内容包括：
    *   软件名称、版本号、官方来源、许可证类型。
    *   风险评估报告、准入审批记录。
    *   已知漏洞列表（CVE）及内部修复状态。
    *   备份存储路径及哈希值。
2.  **源代码关联**：对于用于构建产品的组件，其档案必须与源代码版本控制系统关联，确保任何构建版本所依赖的第三方组件及其版本都是可追溯的。

**（三）应急恢复**

1.  **恢复预案**：必须制定应急恢复预案，确保在外部仓库不可用或软件版本被恶意篡改时，能够迅速从内部备份恢复。
2.  **定期演练**：每年至少进行一次恢复演练，验证备份的可用性和恢复流程的有效性。

# 第五章 安全测试（王思宇） {#第五章-安全测试王思宇 .样式1}

**第二十六条 安全测试质量基线**

安全测试质量基线是产品安全目标的具象化，是各类产品必须满足的最低合格标准，也是发布前的强制质量门禁。任何产品在发布前必须100%满足基线要求，否则视为安全测试不通过，不得进入交付环节。

**（一）漏洞修复时限与要求**

| 漏洞等级 | CVSS v3.1评分 | 修复时限 | 修复要求 |
| :--- | :--- | :--- | :--- |
| **严重 (Critical)** | 9.0 - 10.0 | **7天** | 必须立即修复。 |
| **高危 (High)** | 7.0 - 8.9 | **30天** | 必须修复。 |
| **中危 (Medium)** | 4.0 - 6.9 | **90天** | 建议修复，若不修复需提供风险说明并经审批。 |
| **低危 (Low)** | 0.1 - 3.9 | **酌情处理** | 纳入常规迭代计划，或忽略。 |

**（二）各类安全测试通过标准**

1.  **静态代码分析（SAST）**：
    *   使用公司统一的代码审计工具扫描。
    *   **致命（Critical）、高(High)与中（Medium）** 等级漏洞必须全部修复。
    *   **低(Low)** 等级漏洞由产品研发部门自行决策处理。

2.  **软件成分分析（SCA）**：
    *   使用公司统一的依赖包扫描工具。
    *   **严重（Critical）、高危（High）** 等级的已知漏洞必须修复或升级版本。
    *   **中危（Medium）** 漏洞必须进行评估，并根据漏洞修复时限要求处理。

3.  **动态应用安全测试（DAST）**：
    *   使用WEB应用安全扫描工具。
    *   **高、中危及以上** 漏洞必须修复。
    *   **低危** 漏洞由产品研发部门根据业务影响自行决策处理。

4.  **主机与中间件扫描**：
    *   使用主机漏洞扫描工具。
    *   **高、中危及以上** 缺陷必须修复或提供经批准的合理解释。
    *   Nmap扫描发现的高危端口，如非业务必需必须关闭。

5.  **病毒木马扫描**：
    *   交付物中不得存在任何病毒、木马等恶意程序。

**第二十七条 安全测试过程总览**

安全测试遵循闭环管理原则，划分为五大阶段：1.产品分析→
2.测试设计→3.测试执行→4.结果分析→5.测试总结。测试部门为本过程的主导部门，需协同产品研发、质量管理、配置管理等部门，明确各阶段输入输出，确保安全风险被有效识别、跟踪与闭环。

**第二十七条 产品分析阶段**

本阶段是制定针对性测试策略的基础，由测试部门主导，产品研发部门为主要输入方，共同明确测试范围与重点，旨在全面识别测试对象与潜在风险。

1.  产品版本分析：测试部门需根据产品版本类型（新品/主版本、迭代版本、项目定制版本）评估安全测试的深度与广度，为测试策略制定提供依据。

1\.
新品/主版本（1位/2位版本）：分析其是否为首次发布或架构重大变更，此类版本需进行全面安全测试，并评估引入外部渗透测试的必要性。

2\.
迭代版本（3位版本）：分析其变更内容，若无重大新增功能或高风险架构调整，则采用重点安全测试策略，主要覆盖变更影响范围及依赖环境。

3\.
项目定制版本：分析其定制化内容、所属行业（如政务、金融）及客户特殊安全要求，确定测试范围需兼顾定制功能与产品基线安全。

（二）技术架构分析：产品研发部门需提供系统架构信息，测试部门会同产品研发部门分析分布式、微服务、认证授权机制、数据流等，识别关键模块与接口。

（三）产品形态分析：测试部门基于交付物形态（如Web应用、移动APP、API服务、硬件、部署包），初步确定差异化的测试类型组合。

1\.
应用程序（含PC端与移动端APP/SDK）：关键测试维度包括恶意软件扫描、敏感权限检查（移动端）、数据存储与传输加密、日志脱敏及第三方依赖检查。

2\.
基础组件/软件产品（含Web服务、API服务）：关键测试维度包括WEB漏洞扫描（SQL注入、XSS等）、业务逻辑安全、中间件配置与漏洞检测、异常容错及敏感端口检查。

3\.
硬件产品（如密码设备、签章设备）：关键测试维度包括操作系统漏洞扫描、账号权限与密码安全策略、安全配置及固件安全。

4\.
产品部署包：关键测试维度包括部署过程敏感信息泄露检查、依赖项安全及安装权限管理。

（四）依赖环境分析：产品研发部门提供中间件、数据库、操作系统、第三方库的详细版本信息，测试部门据此评估已知漏洞（CVE）、配置错误及兼容性风险，并选择相应的扫描工具。

（五）安全需求分析：研发部门明确本次版本的变更范围（如新增功能、架构调整、第三方组件升级）及安全需求（如身份认证强度、访问控制粒度、数据加密、安全审计等），测试部门据此评估变更引入的风险，确定测试范围、方法。

**第二十八条 测试设计阶段**

本阶段由测试部门基于产品分析结果，制定可执行的安全测试方案，并组织产品研发等部门进行评审，确保方案的有效性与可行性。

（一）测试范围确定：测试部门明确需要测试的具体模块、接口、服务实例等。

（二）测试类型与方法选择：测试部门确定测试类型（静态代码分析、动态WEB扫描、主机扫描、依赖包扫描、业务逻辑测试、渗透测试）及其执行方法（自动化/人工）。

（三）测试工具选型与策略制定：测试部门根据测试类型选择对应工具（如AppScan,
Nessus等），并制定测试策略（如：新增功能采用"全面测试"，原有功能采用"回归测试"；高风险区域及高位版本引入人工渗透测试）。

（四）业务安全测试用例设计：测试部门设计业务安全测试用例需覆盖垂直越权、水平越权、会话固定、批量越权、密码策略、异常输出脱敏等核心安全维度，每条用例须定义"期望结果+判定标准"，确保对业务逻辑漏洞的有效验证。

**第二十九条 测试执行阶段**

本阶段由测试部门基于产品分析结果，制定可执行的安全测试方案，并组织产品研发等部门进行评审，确保方案的有效性与可行性。

（一）测试执行要求：需完整记录测试过程与证据；按计划执行工具自动化扫描与人工探索（包括业务逻辑测试与提交渗透测试申请）；对研发修复后的漏洞进行复测验证。

（二）研发修复要求：产品研发部门在接到确认的安全缺陷后，应安排修复；修复需彻底，避免引入新问题；提供修复说明以便于测试部门验证。

（三）误报甄别流程：测试部门与产品研发部门需共同对工具扫描结果进行甄别，通过人工验证、检查扫描配置、结合业务上下文分析等方式，确认并剔除误报。

（四）输入与输出：产品研发部门需提供可测试的代码、部署包或在线环境。测试部门输出原始扫描报告、漏洞记录及测试过程记录。

**第三十条 渗透测试专项规范**

渗透测试作为深度安全评估手段，所有需进行渗透测试的产品及项目需遵循以下的申请、提测规范。

（一）适用范围与申请条件

渗透测试的实施应基于产品版本、变更内容及风险等级进行决策，具体场景包括：

1\.
新品与复杂产品：新品首发或架构复杂的重大版本（如密码服务管理平台V1.X）必须申请。

2\.
产品主版本（1位/2位版本）：应根据变更内容及模块暴露度进行风险评估，若涉及核心业务逻辑重构、高价值资产或对外暴露面扩大，则应申请。

3\.
产品迭代版本（3位版本）：原则上以自动化安全测试为主，如无重大新增或高风险变更，可不申请。

4\.
项目交付：涉及金融、政务等高风险领域的项目，或客户合同有明确要求的，必须申请。

（二）职责与协作流程

1\.
测试需求提出：由产品研发部门或测试部门作为申请人，在OA系统中填写《第三方测试申请表》，明确测试类型为"安全测试（渗透测试）"，并详细描述测试需求、预期目标、测试范围、时间要求、测试结果的预期复用性及适用范围。

2\.
测试需求评估：测试部门经理接收申请后，负责对测试需求进行初步评估，确认测试类型、目标、范围的准确性与合理性。

3\.
审批流程：测试部门经理审批通过后，商务部正式发起订单，由测试部门协调产品研发部门与安信天行等外部团队对接。

（三）测试输入与材料要求

为确保测试效果，在对外正式发起测试前，测测试部门作为主导方，负责协调测试环境与资源；研发部门作为配合方，负责提供测试所需的功能与接口清单、业务数据、账号及技术资料：

1\. 功能与接口清单：明确核心业务功能点、接口，排除纯展示类页面。

2\. 业务数据：提供贴近生产环境的铺底数据（可模拟，避免过度脱敏）。

3\.
管理员账号与权限说明：提供覆盖系统各级权限的测试账号，并明确角色对应的操作范围。

4\.
系统架构信息：涉及实际业务系统的，需提供网络拓扑、服务器配置、关键业务流程等。

（四）输出物与报告要求

1\.
测试报告：渗透测试方提供正式的《渗透测试报告》，内容应包含测试范围、漏洞详情、风险等级、复现步骤、修复建议及风险整体评估。

2\.
盖章报告：如项目验收或客户交付需要，产品研发部门应在申请时明确要求提供盖章的正式报告。

**第三十一条 测试总结阶段**

本阶段旨在对测试活动进行全面总结与度量，评估产品安全状况，为发布决策提供依据。由测试部门主导，对应产品研发部门经理共同参与风险评估。

（一）漏洞汇聚与去重：测试部门整合来自不同工具、不同测试类型的漏洞数据，进行汇总、去重与分类。

（二）测试结果度量：测试部门编制《测试总结报告》，安全测试结果章节核心结论需明确：

1\. 是否达成产品安全目标（如：无高危漏洞、满足产品安全需求）。

2\. 是否满足本规范第X条定义的安全测试质量基线。

3\.
遗留风险说明，包括未修复漏洞清单、延期处理计划及经批准的风险接受记录。

（三）风险评估与定级：对于遗留缺陷，由测试部门经理与对应产品研发部门经理共同从技术维度和业务影响维度进行评估，确定最终风险等级。

（四）报告与归档：测试部门输出《测试总结报告》应包含安全测试过程总结、漏洞详情与风险分析、明确的安全测试结论及剩余风险预警，并提交至配置管理部门创建基线归档。

# 第六章 安全发布（王思宇） {#第六章-安全发布王思宇 .样式1}

**第三十二条** **安全发布策略**

本策略旨在建立标准化、自动化的发布流程，杜绝未经授权的发布行为，并将安全要求嵌入到构建环节。

（一）流程标准化：所有产品/项目发布必须通过公司统一的OA电子流程发起，流程应包含必要的审批节点（如测试经理、配置管理员）。任何未经OA流程或线下的发布行为均被视为违规。

（二）构建环境安全可信

1\.
CI/CD系统安全加固：持续集成/持续交付（CI/CD）系统需进行安全加固，包括但不限于：使用强密码策略、定期更新补丁、禁用不必要的插件与服务、配置严格的网络访问控制。构建节点应部署在受控的网络环境中。

2\.
权限最小化与审批：CI/CD系统用户权限必须遵循最小权限原则，关键权限（如管理员权限、敏感环境部署权限）的分配与变更需经过审批并记录，确保权限分配的合规性与可追溯性。

3\.
环境一致性：构建过程必须在指定的、受控的构建节点上执行，确保构建环境的一致性、洁净性，避免因环境差异导致产物异常或引入不可控风险。

（三）自动化安全门禁

1\.
强制安全扫描：CI/CD构建流程必须强制集成关键安全扫描任务，作为不可绕过的质量门禁。这些任务应至少包括：

- 依赖包扫描：使用Dependency Check等工具，检查第三方组件的已知漏洞。

- 静态代码扫描：使用Sonar等工具，检查代码层面的安全漏洞与规范性问题。

- 病毒木马扫描：使用ClamAV、小红伞或指定在线工具对构建产物进行扫描。

2\.
构建阻断机制：任何一项集成的安全扫描任务失败（如发现规定必须修复的高危及以上漏洞），CI/CD构建状态应标记为失败，并自动阻断后续的打包、归档及发布流程。

**第三十三条 发布物完整性检查**

发布物完整性检查旨在确保发布产物从生成到归档的整个生命周期内不被篡改且可验证。

（一）产物生成与数字指纹

1\. **自动生成哈希**：构建成功后，CI/CD流水线需自动为发布的二进制包（如JAR，WAR，ZIP）生成强哈希值（优先使用SHA-256或SHA-512算法）。

2\. **独立存储哈希文件**：生成的哈希值必须独立存储为一个文本文件，文件命名规范为 `{package-name}-{version}.sha256`。

3\. **同步归档**：发布包、哈希文件及其软件物料清单（SBOM）必须作为一个不可分割的整体，同步上传至公司指定的受控库（SVN、Gitlab、多可服务器）进行归档。禁止任何形式的异步补传或手动修改。

（二）完整性验证流程

1\. **产品研发部门自检**：在提交OA发布申请前，申请人必须从归档目录下载发布包、哈希文件及SBOM，并在本地计算发布包的哈希值进行比对，确保两者完全一致。

2\. **配置管理部门核验**：配置管理部门在审批OA发布流程时，必须核对流程中填写的归档路径，验证发布包、哈希文件及SBOM是否同时存在且符合命名规范。

**第三十四条 安全传输与归档**

安全传输与归档旨在确保发布产物在传输和存储过程中的机密性、完整性与可用性。

（一）传输安全

1\.
加密传输：从CI/CD构建服务器到归档服务器之间的网络传输，必须使用安全的加密协议（如SFTP，SCP），防止传输过程中被窃听或篡改。

2\.
访问控制：访问归档目录的账号权限需严格管理，遵循最小权限原则。仅有授权的构建服务账号和配置管理员才具备写入权限。

（二）归档信息可信与可追溯

为建立从源码到产物的可信链，产品研发部门在OA发布流程中必须完整、准确地填写以下信息：

1\. 源码信息：源码在Git/SVN仓库中的地址（URL）及唯一的Commit
ID（此为关联源码与二进制产物的关键证据，必须提供）。

2\. 构建信息：执行本次发布的CI/CD任务名称与构建编号（Build Number）。

3\. 产物信息：发布包、哈希文件及SBOM在归档库中的完整存储路径。

4\. 基础信息：产品版本号、申请人、申请时间等。

（三）发布审查要求：配置管理部门在发布流程终审时，必须履行审查职责，逐一核对OA流程中填写的Commit
ID、构建编号与归档路径是否能正确、唯一地对应，确保整个供应链条的信息是完整、真实且不可篡改的。

**第三十五条 关键系统访问安全**

配置管理部门通过严格的网络隔离与访问控制，保护软件供应链核心资产，降低被外部攻击的风险。

（一）网络区域隔离：所有核心研发系统，包括但不限于源码管理系统（如Gitlab、SVN）、制品库系统（如多可）、CI/CD系统等，必须部署在独立的、逻辑隔离的安全网络域内。

（二）互联网访问控制：研发安全域必须断开与互联网的直接路由，不具备互联网访问权限，以从根本上阻断来自互联网的直接攻击和数据泄露通道。

（三）外部访问安全隧道：任何从外部网络（包括办公网、居家办公等）对研发安全域内系统的访问请求，必须通过公司授权的虚拟专用网络（VPN）
建立安全加密隧道接入，并配合多因素认证（MFA）等强化身份验证机制。

# 第七章 第三方软件安全管理




#  漏洞管理（袁培茹） {#漏洞管理袁培茹 .样式1}

**第六十七条
漏洞发现**，漏洞发现指通过人工或者自动的方法对漏洞进行探测、分析，并证实漏洞存在的真实性的过程。漏洞的发现途径分为三种，即外部检测发现、内部测试和使用发现、用户测试和使用发现。漏洞的信息均以在线表格的形式进行管理《漏洞管理表》。

**外部检测发现：**漏洞管理部门和产品研发部门通过各有效信息渠道定期监测产品安全漏洞情况，需要覆盖监测漏洞类别。当发现相关漏洞公告，需即刻填写《产品安全漏洞问题单》，需要明确漏洞等级和影响产品信息。

**内部测试和使用发现：**测试部对公司产品进行阶段性的漏洞测试，具体策略将会在测试过程中进行体现。当发现安全漏洞，需要将具体问题反馈至对应的产品研发部门。

**用户测试和使用发现：**反馈途径包含客户反馈安全漏洞和内部发现安全漏洞。

1.用户反馈安全漏洞:用户通过项目经理反馈具体产品的安全漏洞问题到产品研发部门,接收人需要第一时间将问题反馈给产品研发部门,产品研发部门填写《产品安全漏洞问题单》，需要明确漏洞等级和影响产品,并将其立即反馈至产品主管领导。

2.公司内部发现安全漏洞:公司内部人员向产品研发部门反馈具体产品的安全漏洞问题，接收人需要第一时间将问题反馈给产品研发部门,产品研发部门填写《产品安全漏洞问题单》，需要明确漏洞等级和影响产品,并将其立即反馈至产品主管领导。

**第六十八条
漏洞接收与验证：**漏洞接收与验证是指通过相应途径接收漏洞报告者提交的漏洞信息，收到漏洞报告后，进行漏洞信息的技术验证、确认和反馈的过程。

1.产品研发部门接收到《产品安全漏洞问题单》，首先应该组织人员就安全漏洞问题进行确认，并根据确认结果进行分析。如果确认和分析结果为对产品没有影响的，由产品研发部门组织编写《漏洞风险说明》。产品研发部门反馈给提出问题人员，并填写《产品安全漏洞问题单》中的信息，问题处理结束。如果确认安全漏洞存在对产品有影响的，根据影响确定漏洞等级参见附件1，并根据等级时间要求组织进行处理。

2.如果分析确认安全漏洞属于公共组组件类漏洞，则需要反馈至组件研发部门，由组件研发部门确认和分析安全漏洞，并确定漏洞等级，给出处理方案。通知所有组件使用部门排查产品安全漏洞，并确认分析。

**第六十九条
安全漏洞解决方案制定及评审**：产品研发部门召集安全漏洞相关的产品主管领导、技术经理、测试人员一起确认漏洞的影响并制定解决方案及处理计划。超危和高危漏洞需产品技术专家小组参与评审并决策处理方案。对于超危和高危漏洞按照不良事故进行上报，根据不良事故管理规范进行事故的判定和处理。

反馈信息给安全漏洞问题提出者：产品研发部门根据计划安排和问题确认情况反馈给安全漏洞问题提出人员，对于用户提出的安全漏洞，需同时编写《漏洞风险说明》提交给用户。

**第七十条
漏洞升级处理：**产品研发部门确认不能解决的漏洞问题，可向项目管理部申请安全漏洞问题升级，由质量管理部门组织产品技术专家小组进行讨论，并由给出解决方案。

**第七十一条
漏洞处置与发布**：产品研发部门指通过升级版本、补丁、更改配置等方式，对漏洞进行处置，提交测试验证通过后，进行补丁包和升级策略发布，必要时并组织相关部门进行培训。

**第七十二条
产品升级和验证：**售后服务部门和实施部门根据升级方案，组织对产品进行升级。对于升级后的产品需要进行验证，形成《产品安全漏洞验证报告》。销售人员负责通知客户关于产品升级的事项，如有升级前的临时应对策略，需通知客户。

**第七十三条**
质量管理部负责监督已发现的公司各产品安全漏洞处理过程，督促相关产品研发部门进行安全漏洞问题的解决与修复，直至安全漏洞问题解决关闭，并更新漏洞管理表。质量管理部负责监管，对于由于不能按照此规定执行的造成的不良后果将会进行追责，上报不良事故并根据不良事故管理规范进行事故的判定和处理。

# 第九章 附则（袁培茹） {#第九章-附则袁培茹 .样式1}

**第七十四条** 本办法适用于公司总部。

**第七十五条** 本管理规范经批准后发布，自发布之日起施行。

**第七十六条** 本办法由质量管理部负责解释。

**附件：1.安全漏洞类型和等级**

+:--:+:---:+:------------:+:------:+:---:+:---:+:---:+:-----------:+
| ** | **  | **定义**     | **安全 |     |     |     | *           |
| 等 | CVS |              | 漏洞类 |     |     |     | *处理意见** |
| 级 | S分 |              | 型（工 |     |     |     |             |
| ** | 数  |              | 具扫描 |     |     |     |             |
|    | **  |              | 结果对 |     |     |     |             |
|    |     |              | 应）** |     |     |     |             |
+----+-----+--------------+--------+-----+-----+-----+-------------+
|    |     |              | **代码 | *   | *   | *   |             |
|    |     |              | 规范** | *依 | *We | *主 |             |
|    |     |              |        | 赖  | b应 | 机  |             |
|    |     |              |        | 包  | 用  | /中 |             |
|    |     |              |        | **  | **  | 间  |             |
|    |     |              |        |     |     | 件  |             |
|    |     |              |        |     |     | **  |             |
+----+-----+--------------+--------+-----+-----+-----+-------------+
| 超 | 9.  | 可导致服务   | 危机   | 危  | 高  | 高  | 全部        |
| 危 | 0 - | 完全瘫痪、核 |        | 机  |     |     | 处理，对于  |
|    | 1   | 心数据泄露、 | （Crit |     |     |     | 是问题需要  |
|    | 0.0 | 权限完全失控 | ical） | （C |     |     | 修复，对于  |
|    |     | 、直接造成重 |        | rit |     |     | 不是问题的  |
|    |     | 大财务损失。 |        | ica |     |     | 需要说明原  |
|    |     |              |        | l） |     |     | 因。超危、  |
|    |     |              |        |     |     |     | 高危漏洞处  |
|    |     |              |        |     |     |     | 理需产品技  |
|    |     |              |        |     |     |     | 术专家小组  |
|    |     |              |        |     |     |     | 参与评审并  |
|    |     |              |        |     |     |     | 决策处理方  |
|    |     |              |        |     |     |     | 案。（1月内 |
|    |     |              |        |     |     |     | 完成修复）  |
+----+-----+--------------+--------+-----+-----+-----+-------------+
| 高 | 7.  | 可导致敏感   | 高     | 高  | 中  | 中  |             |
| 危 | 0 - | 信息泄露、重 |        |     |     |     |             |
|    | 8.9 | 要功能被恶意 | （     | （  |     |     |             |
|    |     | 利用、垂直越 | High） | Hig |     |     |             |
|    |     | 权至管理员。 |        | h） |     |     |             |
+----+-----+--------------+--------+-----+-----+-----+-------------+
| 中 | 4.  | 影响范围     | 中     | 中  | 低  | 低  | 可以有      |
| 危 | 0 - | 有限，或利用 |        |     |     |     | 选择的问题  |
|    | 6.9 | 条件较为苛刻 | （Me   | （  |     |     | 的进行修复  |
|    |     |              | dium） | Me  |     |     | 处理（1周内 |
|    |     |              |        | diu |     |     | 完成修复）  |
|    |     |              |        | m） |     |     |             |
+----+-----+--------------+--------+-----+-----+-----+-------------+
| 低 | 0.  | 轻微的安     | 　低   | 未  |     | 　  | 自行决      |
| 危 | 1 - | 全问题，如低 |        | 知  |     |     | 定是否修改  |
|    | 3.9 | 敏感信息泄露 | （     |     |     |     | （3个工作日 |
|    |     | 、加固建议等 | Low）  | （  |     |     | 完成修复）  |
|    |     |              |        | Unk |     |     |             |
|    |     |              |        | now |     |     |             |
|    |     |              |        | n） |     |     |             |
+----+-----+--------------+--------+-----+-----+-----+-------------+

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  版权声明和保密须知

  本文件版权归属北京数字认证股份有限公司所有，受到有关产权及版权法保护。任何单位和个人未经北京数字认证股份有限公司的书面授权许可，不得复制或引用本文件的任何片断，无论通过电子形式或非电子形式。
  ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------